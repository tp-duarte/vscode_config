/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *--------------------------------------------------------------------------------------------*/

var I=Object.create;var m=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var x=Object.getPrototypeOf,D=Object.prototype.hasOwnProperty;var E=(s,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of w(e))!D.call(s,r)&&r!==t&&m(s,r,{get:()=>e[r],enumerable:!(i=u(e,r))||i.enumerable});return s};var c=(s,e,t)=>(t=s!=null?I(x(s)):{},E(e||!s||!s.__esModule?m(t,"default",{value:s,enumerable:!0}):t,s));var d=c(require("net")),f=c(require("child_process")),l=c(require("fs")),P=c(require("path")),g=process.env.VSCODE_SSH_ASKPASS_HANDLE;g||(console.error("VSCODE_SSH_ASKPASS_HANDLE not set."),process.exit(1));var v=process.argv.slice(2),p=process.env.VSCODE_SSH_ASKPASS_COUNTER;if(process.platform==="win32"){let s=process.env.WINDIR,e=s?P.join(s,"System32","wbem","en-US","csv.xsl"):void 0,t=e&&l.existsSync(e)?e:"csv",r=f.execSync(`wmic process where (commandline like "%ssh-askpass.bat%") get processid,parentprocessid /format:"${t}"`).toString().split(/\r?\n/).map(o=>o.trim()).filter(o=>!!o).map(o=>o.split(",")),_=r.shift(),a=r.map(o=>o.reduce((S,h,A)=>(S[_[A]]=h,S),{})).find(o=>o.ProcessId===String(process.ppid));a&&(p=a.ParentProcessId)}else p=v.shift();var n=d.connect(g,()=>{n.write(JSON.stringify({prompt:v.join(" "),counter:p})+`
`,s=>{s&&(console.error(s),process.exit(1))})});n.setEncoding("utf8");n.on("data",s=>{process.stdout.write(s)});n.on("error",s=>{console.error(s),process.exit(1)});n.on("end",()=>{process.exit(0)});
//# sourceMappingURL=sshAskpass.js.map
